ext { 
  deployProjectName='service-dashboard'
  //deployProjectVersion='0.1'
  tomcatHomeDir='/var/lib/apache/tomcat/apache-tomcat-7.0.52'
  //tomcatHomeDir='/usr/local/bsb/bsb-tools-tomcat/apache-tomcat-6.0.24'
  artifactoryReleaseBaseUrl='http://aftprod00.corp.pgcore.com:8081/artifactory/libs-release-local'
  artifactoryUrl="${artifactoryReleaseBaseUrl}/${deployProjectName}/target/${deployProjectName}.war"

}

task stopTomcat(type:Exec){
   workingDir "${tomcatHomeDir}/bin"
   commandLine './shutdown.sh'
   standardOutput = new ByteArrayOutputStream()
   errorOutput = new ByteArrayOutputStream()
   ext.output = {
      log.quiet standardOutput.toString() + errorOutput.toString()
   }
}

task startTomcat(type:Exec){
   workingDir "${tomcatHomeDir}/bin"
   commandLine './startup.sh'
   standardOutput = new ByteArrayOutputStream()
   errorOutput = new ByteArrayOutputStream()
   ext.output = {
      log.quiet standardOutput.toString() + errorOutput.toString()
   }
}

task deploy(dependsOn:'cleanTomcat') << { 
  ant.get(src:artifactoryUrl,
      dest:"${tomcatHomeDir}/webapps/${deployProjectName}.war",
      username:'ecommerce.automation',
      password:'{DESede}a5TksVNL2YfhFXwAW8jIpg=='
  )
  
}
task cleanTomcat (type:Delete) {
  delete "${tomcatHomeDir}/webapps/${deployProjectName}"
  delete "${tomcatHomeDir}/webapps/${deployProjectName}.war"
}

 

